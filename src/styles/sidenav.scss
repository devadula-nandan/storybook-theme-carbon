@use "@carbon/layout";
@use "@carbon/styles/scss/theme";
@use "@carbon/styles/scss/components/button/tokens" as button-tokens;
@use "mixins";

/**
 * SIDEBAR/NAVIGATION STYLES
 * Styles for the Storybook sidebar navigation panel
 * Includes header, search, tree navigation, and interactive elements
 */

nav.sidebar-container {
  background-color: theme.$layer-01;

  /**
   * SVG Icon Colors
   * Default fill color for sidebar icons
   */
  svg > path {
    fill: theme.$text-secondary;
  }

  /**
   * Sidebar Header
   * Top section with logo and action buttons
   */
  .sidebar-header {
    a {
      border-radius: 0;

      &:focus {
        box-shadow: none;
        border: 2px solid theme.$focus;
        background-color: theme.$layer-selected;
      }
    }
    button {
      @include mixins.button("md");

      /**
       * Remove pseudo-element shadows
       * Clears unwanted default styling
       */
      &::after,
      &::before {
        box-shadow: none;
      }
    }
  }

  /**
   * Recently Opened Search Results
   * Text color for recent items in search dropdown
   */
  .search-result-recentlyOpened {
    * {
      color: theme.$text-secondary;
    }
  }

  /**
   * Search Field
   * Combobox input for filtering stories
   */
  [role="combobox"].search-field {
    border-radius: 0;
    box-shadow: inset 0 -1px 0 theme.$border-strong-01;
    background-color: theme.$layer-02;
    padding: 0;

    /**
     * Search Text & Placeholder
     * Color for input text and placeholder
     */
    *,
    ::placeholder {
      color: theme.$text-secondary;
    }

    /**
     * Focus State for Search Input
     * Shows focus when typing in search field
     */
    &:has(input:focus) {
      @include mixins.focus-state;
    }

    /**
     * Search Field Buttons
     * Clear button and other search controls
     */
    button {
      @include mixins.button("md");
    }

    /**
     * Remove gap from last child
     * Layout adjustment for search controls
     */
    :last-child {
      gap: 0;
    }

    /**
     * Search Suggestions/Results Buttons
     * Interactive elements in search dropdown
     */
    + div {
      button {
        @include mixins.button("md");
        box-shadow: none;
      }
    }
  }

  /**
   * Sidebar Subheadings
   * Category headers in the navigation tree
   */
  .sidebar-subheading {
    color: theme.$text-secondary;

    button {
      @include mixins.button("md");
    }
  }

  /**
   * Sidebar Navigation Items
   * Individual story/folder items in the tree
   */
  .sidebar-item {
    // Use CSS custom property for hover state
    --tree-node-background-hover: var(--cds-layer-hover-02) !important;
    border-radius: 0;

    // Apply button styles without focus (handled separately)
    @include mixins.button(null, "ghost", false);

    /**
     * Navigation Links
     * Story title links
     */
    a {
      color: theme.$text-secondary !important;
    }

    /**
     * Expandable Items
     * Folders that can be expanded/collapsed
     */
    &:has([aria-expanded]) {
      background-color: theme.$layer-02;
    }

    /**
     * Selected/Active Item
     * Currently viewed story with left border indicator
     */
    &[data-selected="true"] {
      background-color: theme.$background-selected;
      box-shadow: inset layout.$spacing-02 0 0 0 theme.$border-interactive;

      &:hover {
        background-color: theme.$layer-hover-02;
      }

      svg {
        color: theme.$text-secondary !important;
      }
    }

    /**
     * Interactive States
     * Hover, active, and focus states for navigation items
     */
    &:focus {
      @include mixins.focus-state;
    }

    /**
     * Button Text Color
     * Ensures proper text color for nested buttons
     */
    > button {
      color: theme.$text-primary;
    }
  }
}
